Mysql索引结构 - BTree索引, Hash索引, full-text全文索引, R-Tree索引



BTree索引

##### B+树-检索原理

每个磁盘块有两个数字n和m(作为比较), 三个指针, 一个指向比n小的, 一个指向n-m之间的, 一个指向比m大的

但叶子才有真实的数据(两个)

注意支干的节点n和m是不存在数据表中的

##### 查找过程

如果要查找数据项29, 那么首先会把磁盘块1由磁盘加载到内存, 此时发生一次IO, 在内存中用二分查找确定29在17和35之间, 锁定磁盘块1的P2指针, 内存时间因为非常短(相较于磁盘的IO)可以忽略不计, 通过磁盘块1的P2指针的磁盘地址把磁盘块3由磁盘加载到内存, 发生第二次IO, 29在26和30之间, 锁定磁盘块3的P2指针, 通过指针加载磁盘块8到内存, 发生第三次IO, 同时内存中做二分查找找到29, 结束查询, 总结三次IO



##### 建立索引的情况

主键自动建立唯一索引

频繁作为查询条件的字段应该创建索引

查询中与其他表关联的字段, 外键关系建立索引

频繁更新的字段不适合创建索引 - 因为每次更新不单单是更新了记录还会更新索引

where条件中用不到的字段不创建索引

单键/组合索引的选择问题 (在高并发下倾向创建组合索引)

查询中排序的字段, 排序字段若通过索引去访问讲大大提升排序速度

查询中统计或分组字段



##### 无需建立索引的情况

表记录太少 (三百万数据以下) 理由: 表记录少时, 建索引会多走io, 但是由上面可知这个过程是需要通过磁盘IO的, 所以此时无需建立索引IO

经常增删改的表

数据重复且分布平均的表字段, 无需建立索引