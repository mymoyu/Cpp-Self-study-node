B+树与B树的基本概念在"1_索引基本知识"里

##### B+树键值插入

当一个数值要插入时,先寻找保存键值记录的叶子结点, 如果该叶子结点已经满了, 那么我们采取平方的方法把其 (分裂) 成两个叶子结点, 将该值放入其中一个叶子结点中

然后调整指针使其指向新叶子结点当中, 然后和其他叶子节点继续用指针连起来

然后再寻找支干结点, 连上, 如果此时支干结点已经满了, 没有指针可供指向它了, 那就把支干结点分裂成两个支干结点 然后再去调整指针, 当然如果支干的父节点也满了, 则同样的方法处理

注意: 当结点满时再插入才会分裂, 由叶节点向根结点逐层处理



##### B+树键值删除

###### 左侧足够使得双方平衡的情况

叶子节点先寻找等于键值的记录, 然后删除对应的指针以及主文件对应的记录

从左侧或右侧中获取键值记录, 使得两个叶节点平衡

如果此时出现了右侧的键值与干结点的值小, 可以调整其干结点此处的值, 如直接替换, 同样左侧结点也要满足b+树的特点, 所以也应该进行查看, 不符则调整

###### 左侧不足(小于百分之五十时)以使得双方平衡的情况

叶子节点先寻找等于键值的记录, 然后删除对应的指针以及主文件对应的记录

如果发现不足以平衡, 那么将此键值记录移动到左侧, 使两者合并, 然后删除空结点

如果合并后, 发现此时指针的结点值不满足大于其叶节点的条件, 那么可以把右侧的叶子结点指针放入到其右侧指针处, 然后变为指针结点值为右侧叶子节点的最小结点

然后此时如果其干结点的父节点的结点值不符合条件, 则可以把爷结点的另一个子节点中索取一个值, 然后其他值向左移动

![image-20220224181653086](.\img\B+树的键值删除(合并情况).png)